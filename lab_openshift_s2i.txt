[student@workstation ~]$ lab openshift-s2i start

Setting up workstation for the Guided Excercise: Creating a Containerized Application with Source-to-Image

 · Installing the tree command.................................  SUCCESS
 Checking local clone of the applications repository:
 · Folder '/home/student/DO180-apps' is a git repo.............  SUCCESS
 · Git repo '/home/student/DO180-apps' has no pending changes..  SUCCESS
 Verifying the OpenShift cluster is running:
 · Log in on OpenShift.........................................  SUCCESS
 · Check the internal registry is up and running...............  SUCCESS
 · Ensuring the 'qclrrk-s2i' project does not exist............  SUCCESS
[student@workstation ~]$ 
[student@workstation ~]$ 
[student@workstation ~]$ 
[student@workstation ~]$ 
[student@workstation ~]$ 
[student@workstation ~]$ cd DO180-apps/
[student@workstation DO180-apps]$ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
[student@workstation DO180-apps]$ git branch
  console
* master
[student@workstation DO180-apps]$ git branch -a
  console
* master
  remotes/origin/HEAD -> origin/master
  remotes/origin/console
  remotes/origin/master
  remotes/origin/s2i
  remotes/origin/testbranch
[student@workstation DO180-apps]$ git checkout s2i
Branch 's2i' set up to track remote branch 's2i' from 'origin'.
Switched to a new branch 's2i'
[student@workstation DO180-apps]$ git status
On branch s2i
Your branch is up to date with 'origin/s2i'.

nothing to commit, working tree clean
[student@workstation DO180-apps]$ vi
vi                  vipw                virtnetworkd        virtsecretd
view                virt-admin          virtnodedevd        virt-ssh-helper
vigr                virt-host-validate  virtnwfilterd       virtstoraged
vim                 virtinterfaced      virtproxyd          virt-what
vimdiff             virtlockd           virtqemud           visudo
vimtutor            virtlogd            virt-qemu-run       
[student@workstation DO180-apps]$ vim php-helloworld/index.php 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ lab openshift-s2i start

Setting up workstation for the Guided Excercise: Creating a Containerized Application with Source-to-Image

 · Installing the tree command.................................  SUCCESS
 Checking local clone of the applications repository:
 · Folder '/home/student/DO180-apps' is a git repo.............  SUCCESS
 · Git repo '/home/student/DO180-apps' has no pending changes..  SUCCESS
 Verifying the OpenShift cluster is running:
 · Log in on OpenShift.........................................  SUCCESS
 · Check the internal registry is up and running...............  SUCCESS
 · Ensuring the 'qclrrk-s2i' project does not exist............  SUCCESS
[student@workstation DO180-apps]$ source /usr/local/etc/ocp4.config
[student@workstation DO180-apps]$ cat /usr/local/etc/ocp4.config
RHT_OCP4_MASTER_API=https://api.eu410.prod.nextcle.com:6443
RHT_OCP4_WILDCARD_DOMAIN=apps.eu410.prod.nextcle.com
RHT_OCP4_NEXUS_SERVER=nexus-common.apps.eu410.prod.nextcle.com
RHT_OCP4_DEV_USER=qclrrk
RHT_OCP4_DEV_PASSWORD=23c3c14ab7de4df8b420
RHT_OCP4_GITHUB_USER=Mica1999
RHT_OCP4_QUAY_USER=laemmerh
[student@workstation DO180-apps]$ oc login -u qclrrk -p 23c3c14ab7de4df8b420 https://api.eu410.prod.nextcle.com:6443
Login successful.

You don't have any projects. You can try to create a new project, by running

    oc new-project <projectname>

[student@workstation DO180-apps]$ oc new-project qclrrk-s2i
Now using project "qclrrk-s2i" on server "https://api.eu410.prod.nextcle.com:6443".

You can add applications to this project with the 'new-app' command. For example, try:

    oc new-app rails-postgresql-example

to build a new example application in Ruby. Or use kubectl to deploy a simple Kubernetes application:

    kubectl create deployment hello-node --image=k8s.gcr.io/e2e-test-images/agnhost:2.33 -- /agnhost serve-hostname

[student@workstation DO180-apps]$ oc new-app php:7.3 --name=php-helloworld https://github.com/Mica1999/DO180-apps#s2i --context-dir php-helloworld
--> Found image fd2077a (11 months old) in image stream "openshift/php" under tag "7.3" for "php:7.3"

    Apache 2.4 with PHP 7.3 
    ----------------------- 
    PHP 7.3 available as container is a base platform for building and running various PHP 7.3 applications and frameworks. PHP is an HTML-embedded scripting language. PHP attempts to make it easy for developers to write dynamically generated web pages. PHP also offers built-in database integration for several commercial and non-commercial database management systems, so writing a database-enabled webpage with PHP is fairly simple. The most common use of PHP coding is probably as a replacement for CGI scripts.

    Tags: builder, php, php73, rh-php73

    * The source repository appears to match: php
    * A source build using source code from https://github.com/Mica1999/DO180-apps#s2i will be created
      * The resulting image will be pushed to image stream tag "php-helloworld:latest"
      * Use 'oc start-build' to trigger a new build

--> Creating resources ...
    imagestream.image.openshift.io "php-helloworld" created
    buildconfig.build.openshift.io "php-helloworld" created
    deployment.apps "php-helloworld" created
    service "php-helloworld" created
--> Success
    Build scheduled, use 'oc logs -f buildconfig/php-helloworld' to track its progress.
    Application is not exposed. You can expose services to the outside world by executing one or more of the commands below:
     'oc expose service/php-helloworld' 
    Run 'oc status' to view your app.
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ oc get pods
NAME                     READY   STATUS     RESTARTS   AGE
php-helloworld-1-build   0/1     Init:1/2   0          9s
[student@workstation DO180-apps]$ oc get pods -w
NAME                     READY   STATUS    RESTARTS   AGE
php-helloworld-1-build   1/1     Running   0          15s
^C[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ oc logs --all-containers -f php-helloworld-1-build
Cloning "https://github.com/Mica1999/DO180-apps" ...
	Commit:	ac1b457767371c8c8d0a8e7bfbfd227c1f3d6d06 (test console log)
	Author:	Student User <student@workstation.lab.example.com>
	Date:	Thu Jan 26 11:43:24 2023 -0500
time="2023-02-20T10:39:47Z" level=info msg="Not using native diff for overlay, this may cause degraded performance for building images: kernel has CONFIG_OVERLAY_FS_REDIRECT_DIR enabled"
I0220 10:39:47.354237       1 defaults.go:102] Defaulting to storage driver "overlay" with options [mountopt=metacopy=on].
Caching blobs under "/var/cache/blobs".
Trying to pull image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746...
Getting image source signatures
Copying blob sha256:a2745c55c3c1fba0208863c387ce5d947a92be3c48577e8436c85b4712546f40
Copying blob sha256:cafe1f99c39ec8cd1f8e696c7031d8c5756311c1ee87f20c65a816889714841c
Copying blob sha256:fd3cd11aea08456c116a42669bde7cf67dc6738c227f0dd9b26d4b677e2a98f1
Copying blob sha256:e0e9ac142996019bde22d55cf51053069e0135f1aae55c9e3bdc77d591c3369b
Copying blob sha256:df920f1b41b8f18f9459e1c35abce96ed6a077e4cc77e4583a7af599be965b1b
Copying config sha256:fd2077affedb833b7b7c930dc7e3b52d9bf1c2add9ce51df1292e0cf18b207b6
Writing manifest to image destination
Storing signatures
Generating dockerfile with builder image image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746
Adding transient rw bind mount for /run/secrets/rhsm
STEP 1/9: FROM image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746
STEP 2/9: LABEL "io.openshift.build.commit.date"="Thu Jan 26 11:43:24 2023 -0500"       "io.openshift.build.commit.id"="ac1b457767371c8c8d0a8e7bfbfd227c1f3d6d06"       "io.openshift.build.commit.ref"="s2i"       "io.openshift.build.commit.message"="test console log"       "io.openshift.build.source-location"="https://github.com/Mica1999/DO180-apps"       "io.openshift.build.source-context-dir"="php-helloworld"       "io.openshift.build.image"="image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746"       "io.openshift.build.commit.author"="Student User <student@workstation.lab.example.com>"
STEP 3/9: ENV OPENSHIFT_BUILD_NAME="php-helloworld-1"     OPENSHIFT_BUILD_NAMESPACE="qclrrk-s2i"     OPENSHIFT_BUILD_SOURCE="https://github.com/Mica1999/DO180-apps"     OPENSHIFT_BUILD_REFERENCE="s2i"     OPENSHIFT_BUILD_COMMIT="ac1b457767371c8c8d0a8e7bfbfd227c1f3d6d06"
STEP 4/9: USER root
STEP 5/9: COPY upload/src /tmp/src
STEP 6/9: RUN chown -R 1001:0 /tmp/src
STEP 7/9: USER 1001
STEP 8/9: RUN /usr/libexec/s2i/assemble
---> Installing application source...
=> sourcing 20-copy-config.sh ...
---> 10:40:04     Processing additional arbitrary httpd configuration provided by s2i ...
=> sourcing 00-documentroot.conf ...
=> sourcing 50-mpm-tuning.conf ...
=> sourcing 40-ssl-certs.sh ...
STEP 9/9: CMD /usr/libexec/s2i/run
COMMIT temp.builder.openshift.io/qclrrk-s2i/php-helloworld-1:94a3a7f5
time="2023-02-20T10:40:05Z" level=warning msg="Adding metacopy option, configured globally"
Getting image source signatures
Copying blob sha256:0b054459c00a34b2b17c5b3c630f25270acb778be3e5c9369185a22d3cf9b42e
Copying blob sha256:73bf0b1db372c204a79bf1beadf847b1f9873bcdf2c48e4339d8ad292fab6efb
Copying blob sha256:84b6bd9f4d0c3e2bc727c4fb62701c07b71c5a33e9803c8f5c71d36a8515ade4
Copying blob sha256:d2ddbf27faca20065be426c2a7140f04899afbd2b811c8cd1bc3fe78b82d1c10
Copying blob sha256:1df73125d4f4eadf6563bec47f190a8303a5245536abd01848fd9cba5189b60c
Copying blob sha256:c13041d290e6769d15247d4b39e1eb6a13d167af7e9d06a9df92a90129241528
Copying config sha256:dc93303fef2c8e2d9afcc30c9b5163b02cec493137b26e3d549e2649733a56e3
Writing manifest to image destination
Storing signatures
--> dc93303fef2
Successfully tagged temp.builder.openshift.io/qclrrk-s2i/php-helloworld-1:94a3a7f5
dc93303fef2c8e2d9afcc30c9b5163b02cec493137b26e3d549e2649733a56e3

Pushing image image-registry.openshift-image-registry.svc:5000/qclrrk-s2i/php-helloworld:latest ...
Getting image source signatures
Copying blob sha256:c13041d290e6769d15247d4b39e1eb6a13d167af7e9d06a9df92a90129241528
Copying blob sha256:a2745c55c3c1fba0208863c387ce5d947a92be3c48577e8436c85b4712546f40
Copying blob sha256:e0e9ac142996019bde22d55cf51053069e0135f1aae55c9e3bdc77d591c3369b
Copying blob sha256:df920f1b41b8f18f9459e1c35abce96ed6a077e4cc77e4583a7af599be965b1b
Copying blob sha256:cafe1f99c39ec8cd1f8e696c7031d8c5756311c1ee87f20c65a816889714841c
Copying blob sha256:fd3cd11aea08456c116a42669bde7cf67dc6738c227f0dd9b26d4b677e2a98f1
Copying config sha256:dc93303fef2c8e2d9afcc30c9b5163b02cec493137b26e3d549e2649733a56e3
Writing manifest to image destination
Storing signatures
Successfully pushed image-registry.openshift-image-registry.svc:5000/qclrrk-s2i/php-helloworld@sha256:85b796130742631c10dc535052a9fc348a3c8fc88ff21e8c232b049c48516d1a
Push successful
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ oc describe deployment/php-helloworld
Name:                   php-helloworld
Namespace:              qclrrk-s2i
CreationTimestamp:      Mon, 20 Feb 2023 05:39:37 -0500
Labels:                 app=php-helloworld
                        app.kubernetes.io/component=php-helloworld
                        app.kubernetes.io/instance=php-helloworld
Annotations:            deployment.kubernetes.io/revision: 2
                        image.openshift.io/triggers:
                          [{"from":{"kind":"ImageStreamTag","name":"php-helloworld:latest"},"fieldPath":"spec.template.spec.containers[?(@.name==\"php-helloworld\")...
                        openshift.io/generated-by: OpenShiftNewApp
Selector:               deployment=php-helloworld
Replicas:               1 desired | 1 updated | 1 total | 1 available | 0 unavailable
StrategyType:           RollingUpdate
MinReadySeconds:        0
RollingUpdateStrategy:  25% max unavailable, 25% max surge
Pod Template:
  Labels:       deployment=php-helloworld
  Annotations:  openshift.io/generated-by: OpenShiftNewApp
  Containers:
   php-helloworld:
    Image:        image-registry.openshift-image-registry.svc:5000/qclrrk-s2i/php-helloworld@sha256:85b796130742631c10dc535052a9fc348a3c8fc88ff21e8c232b049c48516d1a
    Ports:        8080/TCP, 8443/TCP
    Host Ports:   0/TCP, 0/TCP
    Environment:  <none>
    Mounts:       <none>
  Volumes:        <none>
Conditions:
  Type           Status  Reason
  ----           ------  ------
  Available      True    MinimumReplicasAvailable
  Progressing    True    NewReplicaSetAvailable
OldReplicaSets:  <none>
NewReplicaSet:   php-helloworld-76ff47f5c (1/1 replicas created)
Events:
  Type    Reason             Age   From                   Message
  ----    ------             ----  ----                   -------
  Normal  ScalingReplicaSet  109s  deployment-controller  Scaled up replica set php-helloworld-6cb4f5cd4d to 1
  Normal  ScalingReplicaSet  78s   deployment-controller  Scaled up replica set php-helloworld-76ff47f5c to 1
  Normal  ScalingReplicaSet  74s   deployment-controller  Scaled down replica set php-helloworld-6cb4f5cd4d to 0
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ oc expose service php-helloworld
route.route.openshift.io/php-helloworld exposed
[student@workstation DO180-apps]$ oc expose service php-helloworld --name qclrrk-helloworld
route.route.openshift.io/qclrrk-helloworld exposed
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ oc get route
NAME                HOST/PORT                                                  PATH   SERVICES         PORT       TERMINATION   WILDCARD
php-helloworld      php-helloworld-qclrrk-s2i.apps.eu410.prod.nextcle.com             php-helloworld   8080-tcp                 None
qclrrk-helloworld   qclrrk-helloworld-qclrrk-s2i.apps.eu410.prod.nextcle.com          php-helloworld   8080-tcp                 None
[student@workstation DO180-apps]$ oc get route -o jsonpath='{..spec.host}{"\n"}'
php-helloworld-qclrrk-s2i.apps.eu410.prod.nextcle.com qclrrk-helloworld-qclrrk-s2i.apps.eu410.prod.nextcle.com
[student@workstation DO180-apps]$ curl qclrrk-helloworld-qclrrk-s2i.apps.eu410.prod.nextcle.com
Hello, World! php version is 7.3.29
Change should trigger automatic re-build and re-deploy?
[student@workstation DO180-apps]$ vim php-helloworld/index.php 
[student@workstation DO180-apps]$ git status
On branch s2i
Your branch is up to date with 'origin/s2i'.

Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
	modified:   php-helloworld/index.php

no changes added to commit (use "git add" and/or "git commit -a")
[student@workstation DO180-apps]$ git add
Nothing specified, nothing added.
hint: Maybe you wanted to say 'git add .'?
hint: Turn this message off by running
hint: "git config advice.addEmptyPathspec false"
[student@workstation DO180-apps]$ git add .
[student@workstation DO180-apps]$ git status
On branch s2i
Your branch is up to date with 'origin/s2i'.

Changes to be committed:
  (use "git restore --staged <file>..." to unstage)
	modified:   php-helloworld/index.php

[student@workstation DO180-apps]$ git commit
[s2i c29c1f3] changed index page
 1 file changed, 1 insertion(+)
[student@workstation DO180-apps]$ git push origin s2i
Enumerating objects: 7, done.
Counting objects: 100% (7/7), done.
Delta compression using up to 2 threads
Compressing objects: 100% (3/3), done.
Writing objects: 100% (4/4), 384 bytes | 384.00 KiB/s, done.
Total 4 (delta 2), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas: 100% (2/2), completed with 2 local objects.
To https://github.com/Mica1999/DO180-apps
   ac1b457..c29c1f3  s2i -> s2i
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ oc start-build php-helloworld
build.build.openshift.io/php-helloworld-2 started
[student@workstation DO180-apps]$ oc get pods -w
NAME                             READY   STATUS      RESTARTS   AGE
php-helloworld-1-build           0/1     Completed   0          9m25s
php-helloworld-2-build           0/1     Init:0/2    0          8s
php-helloworld-76ff47f5c-ptsz8   1/1     Running     0          8m54s
php-helloworld-2-build           0/1     Init:1/2    0          10s
php-helloworld-2-build           0/1     PodInitializing   0          11s
php-helloworld-2-build           1/1     Running           0          12s
^C[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ oc logs --all-containers -f php-helloworld-2-build
time="2023-02-20T10:49:05Z" level=info msg="Not using native diff for overlay, this may cause degraded performance for building images: kernel has CONFIG_OVERLAY_FS_REDIRECT_DIR enabled"
I0220 10:49:05.334253       1 defaults.go:102] Defaulting to storage driver "overlay" with options [mountopt=metacopy=on].
Caching blobs under "/var/cache/blobs".
Cloning "https://github.com/Mica1999/DO180-apps" ...
	Commit:	c29c1f3b48e13a526527aeb0adb190df9239d1ff (changed index page)
	Author:	Student User <student@workstation.lab.example.com>
	Date:	Mon Feb 20 05:47:52 2023 -0500
Trying to pull image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746...
Getting image source signatures
Copying blob sha256:a2745c55c3c1fba0208863c387ce5d947a92be3c48577e8436c85b4712546f40
Copying blob sha256:e0e9ac142996019bde22d55cf51053069e0135f1aae55c9e3bdc77d591c3369b
Copying blob sha256:df920f1b41b8f18f9459e1c35abce96ed6a077e4cc77e4583a7af599be965b1b
Copying blob sha256:fd3cd11aea08456c116a42669bde7cf67dc6738c227f0dd9b26d4b677e2a98f1
Copying blob sha256:cafe1f99c39ec8cd1f8e696c7031d8c5756311c1ee87f20c65a816889714841c
Copying config sha256:fd2077affedb833b7b7c930dc7e3b52d9bf1c2add9ce51df1292e0cf18b207b6
Writing manifest to image destination
Storing signatures
Generating dockerfile with builder image image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746
Adding transient rw bind mount for /run/secrets/rhsm
STEP 1/9: FROM image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746
STEP 2/9: LABEL "io.openshift.build.source-context-dir"="php-helloworld"       "io.openshift.build.image"="image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746"       "io.openshift.build.commit.author"="Student User <student@workstation.lab.example.com>"       "io.openshift.build.commit.date"="Mon Feb 20 05:47:52 2023 -0500"       "io.openshift.build.commit.id"="c29c1f3b48e13a526527aeb0adb190df9239d1ff"       "io.openshift.build.commit.ref"="s2i"       "io.openshift.build.commit.message"="changed index page"       "io.openshift.build.source-location"="https://github.com/Mica1999/DO180-apps"
STEP 3/9: ENV OPENSHIFT_BUILD_NAME="php-helloworld-2"     OPENSHIFT_BUILD_NAMESPACE="qclrrk-s2i"     OPENSHIFT_BUILD_SOURCE="https://github.com/Mica1999/DO180-apps"     OPENSHIFT_BUILD_REFERENCE="s2i"     OPENSHIFT_BUILD_COMMIT="c29c1f3b48e13a526527aeb0adb190df9239d1ff"
STEP 4/9: USER root
STEP 5/9: COPY upload/src /tmp/src
STEP 6/9: RUN chown -R 1001:0 /tmp/src
STEP 7/9: USER 1001
STEP 8/9: RUN /usr/libexec/s2i/assemble
---> Installing application source...
=> sourcing 20-copy-config.sh ...
---> 10:49:22     Processing additional arbitrary httpd configuration provided by s2i ...
=> sourcing 00-documentroot.conf ...
=> sourcing 50-mpm-tuning.conf ...
=> sourcing 40-ssl-certs.sh ...
STEP 9/9: CMD /usr/libexec/s2i/run
COMMIT temp.builder.openshift.io/qclrrk-s2i/php-helloworld-2:0bc045a1
time="2023-02-20T10:49:23Z" level=warning msg="Adding metacopy option, configured globally"
Getting image source signatures
Copying blob sha256:0b054459c00a34b2b17c5b3c630f25270acb778be3e5c9369185a22d3cf9b42e
Copying blob sha256:73bf0b1db372c204a79bf1beadf847b1f9873bcdf2c48e4339d8ad292fab6efb
Copying blob sha256:84b6bd9f4d0c3e2bc727c4fb62701c07b71c5a33e9803c8f5c71d36a8515ade4
Copying blob sha256:d2ddbf27faca20065be426c2a7140f04899afbd2b811c8cd1bc3fe78b82d1c10
Copying blob sha256:1df73125d4f4eadf6563bec47f190a8303a5245536abd01848fd9cba5189b60c
Copying blob sha256:7175dc7063a965278d31e7bd17cfbbdffe37305c0135ffa239c45e54789b2bdd
Copying config sha256:bd9bdc009885c42a2bc12a1a448f5d7f50fc40a97f00248f14b1e845f5e0f8ae
Writing manifest to image destination
Storing signatures
--> bd9bdc00988
Successfully tagged temp.builder.openshift.io/qclrrk-s2i/php-helloworld-2:0bc045a1
bd9bdc009885c42a2bc12a1a448f5d7f50fc40a97f00248f14b1e845f5e0f8ae

Pushing image image-registry.openshift-image-registry.svc:5000/qclrrk-s2i/php-helloworld:latest ...
Getting image source signatures
Copying blob sha256:cafe1f99c39ec8cd1f8e696c7031d8c5756311c1ee87f20c65a816889714841c
Copying blob sha256:e0e9ac142996019bde22d55cf51053069e0135f1aae55c9e3bdc77d591c3369b
Copying blob sha256:a2745c55c3c1fba0208863c387ce5d947a92be3c48577e8436c85b4712546f40
Copying blob sha256:df920f1b41b8f18f9459e1c35abce96ed6a077e4cc77e4583a7af599be965b1b
Copying blob sha256:fd3cd11aea08456c116a42669bde7cf67dc6738c227f0dd9b26d4b677e2a98f1
Copying blob sha256:7175dc7063a965278d31e7bd17cfbbdffe37305c0135ffa239c45e54789b2bdd
Copying config sha256:bd9bdc009885c42a2bc12a1a448f5d7f50fc40a97f00248f14b1e845f5e0f8ae
Writing manifest to image destination
Storing signatures
Successfully pushed image-registry.openshift-image-registry.svc:5000/qclrrk-s2i/php-helloworld@sha256:faf17228c54f4d1a79de348d6178c87139139cbad529c6de3e93f35f63099ea8
Push successful
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ oc get pods
NAME                              READY   STATUS      RESTARTS   AGE
php-helloworld-1-build            0/1     Completed   0          10m
php-helloworld-2-build            0/1     Completed   0          59s
php-helloworld-68fd897ddb-8fgcp   1/1     Running     0          27s
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ curl qclrrk-helloworld-qclrrk-s2i.apps.eu410.prod.nextcle.com
<br />
<b>Parse error</b>:  syntax error, unexpected 'print' (T_PRINT) in <b>/opt/app-root/src/index.php</b> on line <b>4</b><br />
[student@workstation DO180-apps]$ vim php-helloworld/index.php 
[student@workstation DO180-apps]$ git add .
[student@workstation DO180-apps]$ git commit
[s2i d22558f] Update index page content
 1 file changed, 2 insertions(+), 2 deletions(-)
[student@workstation DO180-apps]$ git push origin s2i
Enumerating objects: 7, done.
Counting objects: 100% (7/7), done.
Delta compression using up to 2 threads
Compressing objects: 100% (3/3), done.
Writing objects: 100% (4/4), 364 bytes | 364.00 KiB/s, done.
Total 4 (delta 2), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas: 100% (2/2), completed with 2 local objects.
To https://github.com/Mica1999/DO180-apps
   c29c1f3..d22558f  s2i -> s2i
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ podman ^Cec -it my-nginx /bin/bash
[student@workstation DO180-apps]$ oc get pods -w
NAME                              READY   STATUS      RESTARTS   AGE
php-helloworld-1-build            0/1     Completed   0          12m
php-helloworld-2-build            0/1     Completed   0          2m49s
php-helloworld-68fd897ddb-8fgcp   1/1     Running     0          2m17s
^C[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ oc start-build php-helloworld
build.build.openshift.io/php-helloworld-3 started
[student@workstation DO180-apps]$ oc get pods -w
NAME                              READY   STATUS      RESTARTS   AGE
php-helloworld-1-build            0/1     Completed   0          12m
php-helloworld-2-build            0/1     Completed   0          3m8s
php-helloworld-3-build            0/1     Init:0/2    0          2s
php-helloworld-68fd897ddb-8fgcp   1/1     Running     0          2m36s
php-helloworld-3-build            0/1     Init:0/2    0          2s
php-helloworld-3-build            0/1     Init:0/2    0          3s
php-helloworld-3-build            0/1     Init:1/2    0          9s
php-helloworld-3-build            0/1     PodInitializing   0          10s
php-helloworld-3-build            1/1     Running           0          11s
^C[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ oc logs --all-containers -f php-helloworld-3-build
Cloning "https://github.com/Mica1999/DO180-apps" ...
	Commit:	d22558f2313635564f322af2cfdbdc896a988cf4 (Update index page content)
	Author:	Student User <student@workstation.lab.example.com>
time="2023-02-20T10:52:10Z" level=info msg="Not using native diff for overlay, this may cause degraded performance for building images: kernel has CONFIG_OVERLAY_FS_REDIRECT_DIR enabled"
	Date:	Mon Feb 20 05:51:01 2023 -0500
I0220 10:52:11.008217       1 defaults.go:102] Defaulting to storage driver "overlay" with options [mountopt=metacopy=on].
Caching blobs under "/var/cache/blobs".
Trying to pull image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746...
Getting image source signatures
Copying blob sha256:e0e9ac142996019bde22d55cf51053069e0135f1aae55c9e3bdc77d591c3369b
Copying blob sha256:fd3cd11aea08456c116a42669bde7cf67dc6738c227f0dd9b26d4b677e2a98f1
Copying blob sha256:a2745c55c3c1fba0208863c387ce5d947a92be3c48577e8436c85b4712546f40
Copying blob sha256:df920f1b41b8f18f9459e1c35abce96ed6a077e4cc77e4583a7af599be965b1b
Copying blob sha256:cafe1f99c39ec8cd1f8e696c7031d8c5756311c1ee87f20c65a816889714841c
Copying config sha256:fd2077affedb833b7b7c930dc7e3b52d9bf1c2add9ce51df1292e0cf18b207b6
Writing manifest to image destination
Storing signatures
Generating dockerfile with builder image image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746
STEP 1/9: FROM image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746
Adding transient rw bind mount for /run/secrets/rhsm
STEP 2/9: LABEL "io.openshift.build.source-location"="https://github.com/Mica1999/DO180-apps"       "io.openshift.build.source-context-dir"="php-helloworld"       "io.openshift.build.image"="image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746"       "io.openshift.build.commit.author"="Student User <student@workstation.lab.example.com>"       "io.openshift.build.commit.date"="Mon Feb 20 05:51:01 2023 -0500"       "io.openshift.build.commit.id"="d22558f2313635564f322af2cfdbdc896a988cf4"       "io.openshift.build.commit.ref"="s2i"       "io.openshift.build.commit.message"="Update index page content"
STEP 3/9: ENV OPENSHIFT_BUILD_NAME="php-helloworld-3"     OPENSHIFT_BUILD_NAMESPACE="qclrrk-s2i"     OPENSHIFT_BUILD_SOURCE="https://github.com/Mica1999/DO180-apps"     OPENSHIFT_BUILD_REFERENCE="s2i"     OPENSHIFT_BUILD_COMMIT="d22558f2313635564f322af2cfdbdc896a988cf4"
STEP 4/9: USER root
STEP 5/9: COPY upload/src /tmp/src
STEP 6/9: RUN chown -R 1001:0 /tmp/src
STEP 7/9: USER 1001
STEP 8/9: RUN /usr/libexec/s2i/assemble
---> Installing application source...
=> sourcing 20-copy-config.sh ...
---> 10:52:28     Processing additional arbitrary httpd configuration provided by s2i ...
=> sourcing 00-documentroot.conf ...
=> sourcing 50-mpm-tuning.conf ...
=> sourcing 40-ssl-certs.sh ...
STEP 9/9: CMD /usr/libexec/s2i/run
COMMIT temp.builder.openshift.io/qclrrk-s2i/php-helloworld-3:231fad20
time="2023-02-20T10:52:28Z" level=warning msg="Adding metacopy option, configured globally"
Getting image source signatures
Copying blob sha256:0b054459c00a34b2b17c5b3c630f25270acb778be3e5c9369185a22d3cf9b42e
Copying blob sha256:73bf0b1db372c204a79bf1beadf847b1f9873bcdf2c48e4339d8ad292fab6efb
Copying blob sha256:84b6bd9f4d0c3e2bc727c4fb62701c07b71c5a33e9803c8f5c71d36a8515ade4
Copying blob sha256:d2ddbf27faca20065be426c2a7140f04899afbd2b811c8cd1bc3fe78b82d1c10
Copying blob sha256:1df73125d4f4eadf6563bec47f190a8303a5245536abd01848fd9cba5189b60c
Copying blob sha256:025466913db81190b5070b44c8d5876b7f57ec9d08a90889f0b8dcd749c42308
Copying config sha256:b491c533e76eb3117125a016c0847a208b4d827cb24c483c73a505d5ec822dde
Writing manifest to image destination
Storing signatures
--> b491c533e76
Successfully tagged temp.builder.openshift.io/qclrrk-s2i/php-helloworld-3:231fad20
b491c533e76eb3117125a016c0847a208b4d827cb24c483c73a505d5ec822dde

Pushing image image-registry.openshift-image-registry.svc:5000/qclrrk-s2i/php-helloworld:latest ...
Getting image source signatures
Copying blob sha256:a2745c55c3c1fba0208863c387ce5d947a92be3c48577e8436c85b4712546f40
Copying blob sha256:fd3cd11aea08456c116a42669bde7cf67dc6738c227f0dd9b26d4b677e2a98f1
Copying blob sha256:df920f1b41b8f18f9459e1c35abce96ed6a077e4cc77e4583a7af599be965b1b
Copying blob sha256:cafe1f99c39ec8cd1f8e696c7031d8c5756311c1ee87f20c65a816889714841c
Copying blob sha256:e0e9ac142996019bde22d55cf51053069e0135f1aae55c9e3bdc77d591c3369b
Copying blob sha256:025466913db81190b5070b44c8d5876b7f57ec9d08a90889f0b8dcd749c42308
Copying config sha256:b491c533e76eb3117125a016c0847a208b4d827cb24c483c73a505d5ec822dde
Writing manifest to image destination
Storing signatures
Successfully pushed image-registry.openshift-image-registry.svc:5000/qclrrk-s2i/php-helloworld@sha256:67bc14fb92dfc00af0bbee81802fcf05b9d279ff5e2d6d108e5d9b5882d528aa
Push successful
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ oc get pods
NAME                              READY   STATUS      RESTARTS   AGE
php-helloworld-1-build            0/1     Completed   0          13m
php-helloworld-2-build            0/1     Completed   0          3m49s
php-helloworld-3-build            0/1     Completed   0          43s
php-helloworld-5d658485f8-xxj55   1/1     Running     0          11s
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ curl qclrrk-helloworld-qclrrk-s2i.apps.eu410.prod.nextcle.com
Hello, World! php version is 7.3.29
Change should trigger automatic re-build and re-deploy?
Hmmmmm. This is a test.
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ 
[student@workstation DO180-apps]$ lab openshift-s2i finish

Completing the Guided Excercise: Creating a Containerized Application with Source-to-Image

 · Log in on OpenShift.........................................  SUCCESS
 · Deleting the 'qclrrk-s2i' project...........................  SUCCESS
[student@workstation DO180-apps]$ 

